<!doctype html><html itemscope itemtype=http://schema.org/WebPage lang=cn class=no-js><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><link rel=canonical type=text/html href=https://Zero-Kq.github.io/docsy/blog/ros/><meta name=robots content="noindex, nofollow"><link rel="shortcut icon" href=/docsy/favicons/favicon.ico><link rel=apple-touch-icon href=/docsy/favicons/apple-touch-icon-180x180.png sizes=180x180><link rel=icon type=image/png href=/docsy/favicons/favicon-16x16.png sizes=16x16><link rel=icon type=image/png href=/docsy/favicons/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=/docsy/favicons/android-36x36.png sizes=36x36><link rel=icon type=image/png href=/docsy/favicons/android-48x48.png sizes=48x48><link rel=icon type=image/png href=/docsy/favicons/android-72x72.png sizes=72x72><link rel=icon type=image/png href=/docsy/favicons/android-96x96.png sizes=96x96><link rel=icon type=image/png href=/docsy/favicons/android-144x144.png sizes=144x144><link rel=icon type=image/png href=/docsy/favicons/android-192x192.png sizes=192x192><title>ROS | Zerokq</title>
<meta name=description content="Robot Operating System 机器人操作系统框架，涵盖 ROS/ROS2 开发、工具链使用、包管理与系统集成实践。"><meta property="og:url" content="https://Zero-Kq.github.io/docsy/blog/ros/"><meta property="og:site_name" content="Zerokq"><meta property="og:title" content="ROS"><meta property="og:description" content="Robot Operating System 机器人操作系统框架，涵盖 ROS/ROS2 开发、工具链使用、包管理与系统集成实践。"><meta property="og:locale" content="cn"><meta property="og:type" content="website"><meta itemprop=name content="ROS"><meta itemprop=description content="Robot Operating System 机器人操作系统框架，涵盖 ROS/ROS2 开发、工具链使用、包管理与系统集成实践。"><meta itemprop=datePublished content="2026-02-25T15:18:48+08:00"><meta itemprop=dateModified content="2026-02-25T15:18:48+08:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="ROS"><meta name=twitter:description content="Robot Operating System 机器人操作系统框架，涵盖 ROS/ROS2 开发、工具链使用、包管理与系统集成实践。"><link rel=preload href=/docsy/scss/main.min.b3c5d5b5e4fe744101b7961318bcd54d586465cd4abf620f17de0fb0b88e151b.css as=style integrity="sha256-s8XVteT+dEEBt5YTGLzVTVhkZc1Kv2IPF94PsLiOFRs=" crossorigin=anonymous><link href=/docsy/scss/main.min.b3c5d5b5e4fe744101b7961318bcd54d586465cd4abf620f17de0fb0b88e151b.css rel=stylesheet integrity="sha256-s8XVteT+dEEBt5YTGLzVTVhkZc1Kv2IPF94PsLiOFRs=" crossorigin=anonymous><script src=https://code.jquery.com/jquery-3.7.1.min.js integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin=anonymous></script></head><body class="td-section td-blog"><header><nav class="td-navbar js-navbar-scroll" data-bs-theme=dark><div class="container-fluid flex-column flex-md-row"><a class=navbar-brand href=/docsy/><span class="navbar-brand__logo navbar-logo"><svg viewBox="0 0 640 640"><path d="M304 70.1C313.1 61.9 326.9 61.9 336 70.1l232 208C577.9 286.9 578.7 302.1 569.8 312 560.9 321.9 545.8 322.7 535.9 313.8L527.9 306.6V511.9c0 35.3000000000001-28.7 64-64 64h-288c-35.3.0-64-28.6999999999999-64-64V306.6L103.9 313.8C94 322.6 78.9 321.8 70 312 61.1 302.2 62 287 71.8 278.1L304 70.1zm16 50.1L160 263.7V512C160 520.8 167.2 528 176 528h48V424c0-39.8 32.2-72 72-72h48c39.8.0 72 32.2 72 72V528h48C472.8 528 480 520.8 480 512V263.7L320 120.3zM272 528h96V424c0-13.3-10.7-24-24-24H296c-13.3.0-24 10.7-24 24V528z"/></svg></span><span class=navbar-brand__name>Zerokq</span></a><div class="td-navbar-nav-scroll ms-md-auto" id=main_navbar><ul class=navbar-nav><li class=nav-item><a class=nav-link href=/docsy/about/><span>关于</span></a></li><li class=nav-item><a class=nav-link href=/docsy/docs/><span>说明</span></a></li><li class=nav-item><a class="nav-link active" href=/docsy/blog/><span>博客</span></a></li><li class=nav-item><a class=nav-link href=/docsy/reviews/><span>读后感</span></a></li><li class="nav-item dropdown d-none d-lg-block"><div class=dropdown><a class="nav-link dropdown-toggle" href=# role=button data-bs-toggle=dropdown aria-haspopup=true aria-expanded=false>中文(Chinese)</a><ul class=dropdown-menu><li><a class=dropdown-item href=/docsy/en/>English</a></li></ul></div></li></ul></div><div class="d-none d-lg-block"><div class=td-search><div class=td-search__icon></div><input type=search class="td-search__input form-control td-search-input" placeholder=搜索 aria-label=搜索 autocomplete=off></div></div></div></nav></header><div class="container-fluid td-outer"><div class=td-main><div class="row flex-xl-nowrap"><div class="col-12 col-md-3 col-xl-2 td-sidebar d-print-none"></div><div class="d-none d-xl-block col-xl-2 td-toc d-print-none"></div><main class="col-12 col-md-9 col-xl-8 ps-md-5 pe-md-4" role=main><div class=td-content><div class="pageinfo pageinfo-primary d-print-none"><p>打印此章节
<a href=# onclick="return print(),!1">点击打印</a>.</p><p><a href=/docsy/blog/ros/>显示常规版本</a>.</p></div><h1 class=title>ROS</h1><div class=lead>Robot Operating System 机器人操作系统框架，涵盖 ROS/ROS2 开发、工具链使用、包管理与系统集成实践。</div><ul><li><a href=#pg-d161b05252d41fc3c89b6e5fbe64ba81>Ubuntu 24.04 安装 ROS 2 Jazzy 完整指南</a></li><li><a href=#pg-e7128b09c8d514d5d3e6eee9e5b47feb>理解 ROS 2 的 node 和 topic</a></li><li><a href=#pg-6f2539b6d098ac8698b8c0db03e709c5>理解 ROS 2 的 Services, Params 和 Actions</a></li></ul><div class=content></div></div><div class=td-content><h1 id=pg-d161b05252d41fc3c89b6e5fbe64ba81>Ubuntu 24.04 安装 ROS 2 Jazzy 完整指南</h1><div class="td-byline mb-4"><time datetime=2026-02-25 class=text-body-secondary>2026年2月25日</time></div><p><img src=/Docsy/images/jazzy-small.png alt="ROS 2 Jazzy"></p><h2 id=什么是-ros-2>什么是 ROS 2？</h2><p>ROS 2（Robot Operating System 2）是 ROS 的下一代版本，是一个开源的机器人操作系统框架。ROS 2 专为现代机器人应用设计，提供了分布式计算、实时性能、多平台支持和更好的安全性等特性。</p><h3 id=ros-2-的主要特点>ROS 2 的主要特点</h3><ul><li><strong>分布式架构</strong>：支持多机器人和多计算机之间的通信</li><li><strong>实时性能</strong>：提供实时通信和调度能力</li><li><strong>跨平台支持</strong>：支持 Linux、Windows 和 macOS</li><li><strong>多种编程语言</strong>：支持 C++、Python、Java 等</li><li><strong>模块化设计</strong>：通过节点（Node）和话题（Topic）实现松耦合的通信</li><li><strong>丰富的工具链</strong>：提供命令行工具、可视化工具（rqt）和调试工具</li></ul><p>ROS 2 Jazzy 是 ROS 2 的一个长期支持（LTS）版本，支持 Ubuntu Noble 24.04 的 amd64 和 arm64 架构。在网络通畅的情况下，安装较为顺利，未发现明显问题。</p><h2 id=1-系统环境准备>1. 系统环境准备</h2><h3 id=11-设置-locale>1.1 设置 Locale</h3><p>设置系统 locale 为 UTF-8 编码，确保 ROS 2 正常运行：</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#8f5902;font-style:italic># 检查当前 locale</span>
</span></span><span style=display:flex><span>locale
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># 如果不是 UTF-8，先安装 locales</span>
</span></span><span style=display:flex><span>sudo apt update <span style=color:#ce5c00;font-weight:700>&amp;&amp;</span> sudo apt install locales
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># 生成 en_US.UTF-8 locale</span>
</span></span><span style=display:flex><span>sudo locale-gen en_US en_US.UTF-8
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># 更新系统 locale</span>
</span></span><span style=display:flex><span>sudo update-locale <span style=color:#000>LC_ALL</span><span style=color:#ce5c00;font-weight:700>=</span>en_US.UTF-8 <span style=color:#000>LANG</span><span style=color:#ce5c00;font-weight:700>=</span>en_US.UTF-8
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># 设置当前会话的 locale</span>
</span></span><span style=display:flex><span><span style=color:#204a87>export</span> <span style=color:#000>LANG</span><span style=color:#ce5c00;font-weight:700>=</span>en_US.UTF-8
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># 再次检查 locale 确认设置成功</span>
</span></span><span style=display:flex><span>locale
</span></span></code></pre></div><h3 id=12-添加-ros-2-apt-源>1.2 添加 ROS 2 APT 源</h3><p>确保启用 Ubuntu Universe 仓库，并添加 ROS 2 的 APT 源：</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#8f5902;font-style:italic># 安装软件属性管理工具</span>
</span></span><span style=display:flex><span>sudo apt install software-properties-common
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># 启用 Universe 仓库</span>
</span></span><span style=display:flex><span>sudo add-apt-repository universe
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># 安装 curl（如果尚未安装）</span>
</span></span><span style=display:flex><span>sudo apt update <span style=color:#ce5c00;font-weight:700>&amp;&amp;</span> sudo apt install curl -y
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># 获取最新版本的 ROS APT 源包</span>
</span></span><span style=display:flex><span><span style=color:#204a87>export</span> <span style=color:#000>ROS_APT_SOURCE_VERSION</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#204a87;font-weight:700>$(</span>curl -s https://api.github.com/repos/ros-infrastructure/ros-apt-source/releases/latest <span style=color:#000;font-weight:700>|</span> grep -F <span style=color:#4e9a06>&#34;tag_name&#34;</span> <span style=color:#000;font-weight:700>|</span> awk -F<span style=color:#4e9a06>\&#34;</span> <span style=color:#4e9a06>&#39;{print $4}&#39;</span><span style=color:#204a87;font-weight:700>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># 下载 ROS 2 APT 源 deb 包</span>
</span></span><span style=display:flex><span>curl -L -o /tmp/ros2-apt-source.deb <span style=color:#4e9a06>&#34;https://github.com/ros-infrastructure/ros-apt-source/releases/download/</span><span style=color:#4e9a06>${</span><span style=color:#000>ROS_APT_SOURCE_VERSION</span><span style=color:#4e9a06>}</span><span style=color:#4e9a06>/ros2-apt-source_</span><span style=color:#4e9a06>${</span><span style=color:#000>ROS_APT_SOURCE_VERSION</span><span style=color:#4e9a06>}</span><span style=color:#4e9a06>.</span><span style=color:#204a87;font-weight:700>$(</span>. /etc/os-release <span style=color:#ce5c00;font-weight:700>&amp;&amp;</span> <span style=color:#204a87>echo</span> <span style=color:#4e9a06>${</span><span style=color:#000>UBUNTU_CODENAME</span><span style=color:#204a87;font-weight:700>:-</span><span style=color:#4e9a06>${</span><span style=color:#000>VERSION_CODENAME</span><span style=color:#4e9a06>}}</span><span style=color:#204a87;font-weight:700>)</span><span style=color:#4e9a06>_all.deb&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># 安装 APT 源包</span>
</span></span><span style=display:flex><span>sudo dpkg -i /tmp/ros2-apt-source.deb
</span></span></code></pre></div><h3 id=13-安装开发工具>1.3 安装开发工具</h3><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#8f5902;font-style:italic># 更新包列表并安装 ROS 开发工具</span>
</span></span><span style=display:flex><span>sudo apt update <span style=color:#ce5c00;font-weight:700>&amp;&amp;</span> sudo apt install ros-dev-tools
</span></span></code></pre></div><h2 id=2-安装-ros-2>2. 安装 ROS 2</h2><h3 id=21-安装-ros-2-desktop>2.1 安装 ROS 2 Desktop</h3><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#8f5902;font-style:italic># 更新系统包</span>
</span></span><span style=display:flex><span>sudo apt update
</span></span><span style=display:flex><span>sudo apt upgrade
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># 安装 ROS 2 Jazzy Desktop（包含可视化工具）</span>
</span></span><span style=display:flex><span>sudo apt install ros-jazzy-desktop
</span></span></code></pre></div><h3 id=22-设置环境变量>2.2 设置环境变量</h3><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#8f5902;font-style:italic># 临时设置当前会话的环境变量</span>
</span></span><span style=display:flex><span><span style=color:#204a87>source</span> /opt/ros/jazzy/setup.bash
</span></span></code></pre></div><h2 id=3-测试-fastdds-通信>3. 测试 FastDDS 通信</h2><p>FastDDS 是 ROS 2 的默认通信中间件。通过以下步骤测试安装是否成功：</p><ol><li><strong>在第一个终端中启动 talker 节点</strong>：</li></ol><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>ros2 run demo_nodes_cpp talker
</span></span></code></pre></div><ol start=2><li><strong>在第二个终端中启动 listener 节点</strong>：</li></ol><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#8f5902;font-style:italic># 先设置环境变量</span>
</span></span><span style=display:flex><span><span style=color:#204a87>source</span> /opt/ros/jazzy/setup.bash
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># 运行 listener</span>
</span></span><span style=display:flex><span>ros2 run demo_nodes_py listener
</span></span></code></pre></div><p>如果两个终端都能正常打印消息，说明安装成功：</p><p><img src=/Docsy/images/fastdds_demo.png alt="FastDDS 测试"></p><h2 id=4-配置-shell-启动脚本>4. 配置 Shell 启动脚本</h2><p>ROS 2 的 shell 工作区概念允许在同一台电脑上同时安装多个不同版本的 ROS，通过启动脚本来切换版本。如果不加载安装文件，您将无法访问 ROS 2 命令，也无法查找或使用 ROS 2 软件包。</p><h3 id=41-添加到-bashrc>4.1 添加到 ~/.bashrc</h3><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#8f5902;font-style:italic># 编辑 ~/.bashrc 文件（使用您喜欢的编辑器，如 nano、vim 或 subl）</span>
</span></span><span style=display:flex><span>nano ~/.bashrc
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># 或者使用 Sublime Text</span>
</span></span><span style=display:flex><span>subl ~/.bashrc
</span></span></code></pre></div><p>在文件末尾添加以下内容：</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#204a87>source</span> /opt/ros/jazzy/setup.bash
</span></span></code></pre></div><h3 id=42-使配置生效>4.2 使配置生效</h3><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#8f5902;font-style:italic># 重新加载配置</span>
</span></span><span style=display:flex><span><span style=color:#204a87>source</span> ~/.bashrc
</span></span></code></pre></div><h3 id=43-验证配置>4.3 验证配置</h3><p>打开一个新的命令行窗口，直接输入 <code>ros2</code>，如果显示如下内容，说明配置成功：</p><p><img src=/Docsy/images/ros2_init.png alt="ROS 2 初始化"></p><h2 id=5-使用-turtlesim>5. 使用 Turtlesim</h2><p>Turtlesim 是一个轻量级的 ROS 2 学习模拟器。它以最基本的层面演示了 ROS 2 的功能，让您了解以后使用真实机器人或机器人模拟器时会遇到的问题。</p><h3 id=51-安装-turtlesim>5.1 安装 Turtlesim</h3><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>sudo apt update
</span></span><span style=display:flex><span>sudo apt install ros-jazzy-turtlesim
</span></span></code></pre></div><h3 id=52-验证安装>5.2 验证安装</h3><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>ros2 pkg executables turtlesim
</span></span></code></pre></div><p>如果显示以下内容，说明安装成功：</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>turtlesim draw_square
</span></span><span style=display:flex><span>turtlesim mimic
</span></span><span style=display:flex><span>turtlesim turtle_teleop_key
</span></span><span style=display:flex><span>turtlesim turtlesim_node
</span></span></code></pre></div><h3 id=53-运行-turtlesim>5.3 运行 Turtlesim</h3><ol><li><strong>启动 Turtlesim 节点</strong>：</li></ol><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>ros2 run turtlesim turtlesim_node
</span></span></code></pre></div><ol start=2><li><strong>在另一个终端中启动键盘控制节点</strong>：</li></ol><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>ros2 run turtlesim turtle_teleop_key
</span></span></code></pre></div><p>保持 <code>turtle_teleop_key</code> 的窗口处于激活状态，通过方向键可以控制乌龟移动。此时乌龟指代的是无人机的移动和控制方式。</p><p><img src=/Docsy/images/turtle_teleop_key.png alt="Turtlesim 键盘控制"></p><h2 id=6-安装和使用-rqt>6. 安装和使用 rqt</h2><p>rqt 是 ROS 2 的图形用户界面 (GUI) 工具。rqt 中的所有操作都可以在命令行中完成，但 rqt 提供了一种更友好的方式来操作 ROS 2 元素。</p><h3 id=61-安装-rqt>6.1 安装 rqt</h3><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>sudo apt update
</span></span><span style=display:flex><span>sudo apt install <span style=color:#4e9a06>&#39;~nros-jazzy-rqt*&#39;</span>
</span></span></code></pre></div><h3 id=62-运行-rqt>6.2 运行 rqt</h3><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>rqt
</span></span></code></pre></div><h3 id=63-使用-rqt-调用服务>6.3 使用 rqt 调用服务</h3><p>在 Turtlesim 运行时，可以通过 rqt 调用服务：</p><ol><li>从下拉菜单选择 <strong>Plugins</strong> → <strong>Services</strong> → <strong>Service Caller</strong></li><li>选择服务 <code>/spawn</code></li><li>在此处可以直接调整生成位置（x、y 坐标）、实例名称等参数</li><li>点击 <strong>Call</strong> 按钮</li></ol><p><img src=/Docsy/images/rqt_services_servicecaller.png alt="rqt 服务调用器"></p><p>如果服务调用成功，您应该会看到一只新的海龟（同样是随机设计的）在您输入的 x 和 y 坐标处生成。</p><p><img src=/Docsy/images/call_spawn.png alt="调用 spawn 服务"></p><h3 id=64-控制新创建的海龟实例>6.4 控制新创建的海龟实例</h3><p>如果要控制新创建的实例 <code>turtle2</code>，可以在新的终端中执行：</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>ros2 run turtlesim turtle_teleop_key --ros-args --remap turtle1/cmd_vel:<span style=color:#ce5c00;font-weight:700>=</span>turtle2/cmd_vel
</span></span></code></pre></div><p>然后在这个终端控制即可。</p><p>如果您刷新 rqt 中的服务列表，您还会看到除了 <code>/turtle1/...</code> 之外，现在还有与新海龟相关的服务 <code>/turtle2/...</code>。</p><hr><h2 id=参考文档>参考文档</h2><ul><li><a href=https://docs.ros.org/en/jazzy/Installation/Ubuntu-Install-Debians.html>ROS 2 Jazzy 官方安装指南</a></li><li><a href=https://docs.ros.org/en/jazzy/>ROS 2 官方文档</a></li></ul></div><div class=td-content style=page-break-before:always><h1 id=pg-e7128b09c8d514d5d3e6eee9e5b47feb>理解 ROS 2 的 node 和 topic</h1><div class="td-byline mb-4"><time datetime=2026-02-25 class=text-body-secondary>2026年2月25日</time></div><h2 id=1-理解-node>1. 理解 node</h2><p>node 是 ROS 2 实现模块化的基本组件。ROS 中的每个 node 都应负责单一的模块化功能，例如控制车轮电机或发布来自激光测距仪的传感器数据。每个 node 都可以通过 topic、服务、动作或参数与其他 node 发送和接收数据。</p><p>一个完整的机器人系统由许多协同工作的 node 组成。在 ROS 2 中，一个可执行文件（C++ 程序、Python 程序等）可以包含一个或多个 node。</p><p><img src=/Docsy/images/Nodes-TopicandService.gif alt="ROS 2 node 交互"></p><p>上图展示了两个 ROS 2 node 是如何交互的。</p><h3 id=11-ros-2-启动命令>1.1 ROS 2 启动命令</h3><p>使用以下命令启动 node：</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>ros2 run &lt;package_name&gt; &lt;executable_name&gt;
</span></span></code></pre></div><p>例如：</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>ros2 run demo_nodes_cpp talker
</span></span></code></pre></div><p>其中 <code>demo_nodes_cpp</code> 是包名字，<code>talker</code> 是可执行文件名。</p><h3 id=12-查看-node-列表>1.2 查看 node 列表</h3><p>node 名称可以使用以下命令查找：</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>ros2 node list
</span></span></code></pre></div><p><img src=/Docsy/images/ros2-node-list.png alt="ROS 2 node 列表"></p><p>可以看到 <code>/talker</code> 已经显示出来了。</p><h3 id=13-node-名称重映射remapping>1.3 node 名称重映射（Remapping）</h3><p>通过 <code>--remap</code> 参数可以重映射 node 名称：</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>ros2 run turtlesim turtlesim_node --ros-args --remap __node:<span style=color:#ce5c00;font-weight:700>=</span>my_turtle
</span></span></code></pre></div><p>上述命令中 <code>--remap __node:=my_turtle</code> 将 node 名称定义为 <code>my_turtle</code>，通过 <code>ros2 node list</code> 应该也可以看到这个新建的实例 <code>/my_turtle</code>。</p><h3 id=14-查看-node-信息>1.4 查看 node 信息</h3><p>使用以下命令查看 node 的详细信息：</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>ros2 node info &lt;node_name&gt;
</span></span></code></pre></div><p>例如：</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>ros2 node info /talker
</span></span></code></pre></div><p>注意要加斜杠。</p><p><img src=/Docsy/images/ros2-node-info.png alt="ROS 2 node 信息"></p><h2 id=2-理解-topic>2. 理解 topic</h2><p>在上个章节的图片中，我们已经可以看到，publisher node 通过 topic 将信息发送给 subscriber 的过程，只要一个 node 订阅了 topic，就可以收到对应的消息。</p><p>ROS 2 将复杂的系统分解为许多模块化 node。topic 是 ROS 图的重要元素，充当 node 交换消息的总线。</p><p><img src=/Docsy/images/Topic-SinglePublisherandSingleSubscriber.gif alt=单发布者单订阅者></p><p>一个 node 可以将数据发布到任意数量的 topic，并同时订阅任意数量的 topic。</p><p><img src=/Docsy/images/Topic-MultiplePublisherandMultipleSubscriber.gif alt=多发布者多订阅者></p><p>topic 是在 node 之间以及系统不同部分之间移动数据的主要方式之一。</p><h3 id=21-使用-rqt_graph-检查通信状态>2.1 使用 rqt_graph 检查通信状态</h3><p>通过 <code>rqt_graph</code> 可以可视化检查当前 ROS 2 系统的通信状态：</p><ol><li>打开第一个终端，启动 talker node：</li></ol><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>ros2 run demo_nodes_cpp talker
</span></span></code></pre></div><ol start=2><li>打开第二个终端，启动 listener node：</li></ol><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>ros2 run demo_nodes_cpp listener
</span></span></code></pre></div><ol start=3><li>使用以下命令打开 rqt_graph：</li></ol><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>ros2 run rqt_graph rqt_graph
</span></span></code></pre></div><p>可以看到 talker 和 listener 通过 <code>/chatter</code> 这个 topic 建立通信。node 正在向 topic 发布数据，并且该 node 订阅了该 topic 以接收数据。</p><p><code>rqt_graph</code> 的突出显示功能在检查具有许多 node 和 topic 以多种不同方式连接的更复杂的系统时非常有用。</p><p><img src=/Docsy/images/rqt_gragh.png alt="rqt_graph 可视化"></p><h3 id=22-查看-topic-列表>2.2 查看 topic 列表</h3><p>在新终端中运行以下命令将返回系统中当前活动的所有 topic 的列表：</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>ros2 topic list
</span></span></code></pre></div><p>重要：使用 <code>-t</code> 参数可以在括号中附加 topic 类型：</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>ros2 topic list -t
</span></span></code></pre></div><p>输出示例：</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>/chatter <span style=color:#ce5c00;font-weight:700>[</span>std_msgs/msg/String<span style=color:#ce5c00;font-weight:700>]</span>
</span></span><span style=display:flex><span>/parameter_events <span style=color:#ce5c00;font-weight:700>[</span>rcl_interfaces/msg/ParameterEvent<span style=color:#ce5c00;font-weight:700>]</span>
</span></span><span style=display:flex><span>/rosout <span style=color:#ce5c00;font-weight:700>[</span>rcl_interfaces/msg/Log<span style=color:#ce5c00;font-weight:700>]</span>
</span></span></code></pre></div><p>topic 类型是本文档的重要内容，后续对 topic 的命令行应用都基于类型进行。</p><h3 id=23-查看-topic-信息>2.3 查看 topic 信息</h3><p>topic 不必只是一对一的交流；它们可以是一对多、多对一或多对多。通过以下命令来查看当前订阅数量：</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>ros2 topic info /chatter
</span></span></code></pre></div><p>返回示例：</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>Type: std_msgs/msg/String
</span></span><span style=display:flex><span>Publisher count: <span style=color:#0000cf;font-weight:700>1</span>
</span></span><span style=display:flex><span>Subscription count: <span style=color:#0000cf;font-weight:700>1</span>
</span></span></code></pre></div><h3 id=24-查看-topic-数据>2.4 查看 topic 数据</h3><p>使用以下命令查看正在发布的 topic 数据：</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>ros2 topic <span style=color:#204a87>echo</span> &lt;topic_name&gt;
</span></span></code></pre></div><p>例如：</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>ros2 topic <span style=color:#204a87>echo</span> /chatter
</span></span></code></pre></div><p>注意 topic 名称前要加斜杠。</p><p><img src=/Docsy/images/ros2_topic_echo_chatter.png alt="ROS 2 topic echo"></p><p>现在返回 rqt_graph 并取消选中 &ldquo;debug&rdquo; 框，可以见到新增的订阅 <code>/_ros2cli_100752</code>，也就是刚才我们通过命令行命令 echo 创建的 node。</p><p><img src=/Docsy/images/ros2-rqt-graph-ubdebug.png alt="rqt_graph 取消 debug"></p><h3 id=25-查看接口数据结构>2.5 查看接口/数据结构</h3><p>在前面运行过了 <code>ros2 topic list -t</code> 后，得知了 <code>/chatter</code> 的接口为 <code>[std_msgs/msg/String]</code>。</p><p>运行以下命令查看接口定义：</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>ros2 interface show std_msgs/msg/String
</span></span></code></pre></div><p>返回：</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span># This was originally provided as an example message.
</span></span><span style=display:flex><span># It is deprecated as of Foxy
</span></span><span style=display:flex><span># It is recommended to create your own semantically meaningful message.
</span></span><span style=display:flex><span># However if you would like to continue using this please use the equivalent in example_msgs.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>string data
</span></span></code></pre></div><p>可以得知为字符串数据结构，字段为 <code>data</code>。</p><h3 id=26-发布-topic-消息>2.6 发布 topic 消息</h3><p>得知消息结构后，通过以下命令可以直接从终端发送命令数据到 topic 中：</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>ros2 topic pub &lt;topic_name&gt; &lt;msg_type&gt; <span style=color:#4e9a06>&#39;&lt;args&gt;&#39;</span>
</span></span></code></pre></div><p><code>&lt;args></code> 是要传递给 topic 的实际数据，采用正确的数据结构。如上 interface 为 <code>string data</code> 时，<code>data</code> 就是构建 YAML 字符串的 key。</p><p>如下几种方式都可以发布：</p><ol><li><strong>构建 YAML 字符串发布</strong>：</li></ol><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>ros2 topic pub /chatter std_msgs/msg/String <span style=color:#4e9a06>&#34;{data: &#39;Hello from manual pub.&#39;}&#34;</span>
</span></span></code></pre></div><p>可以看到 subscriber node 同时收到了两个 node 的信息。</p><p><img src=/Docsy/images/maunal-pub-info.png alt=手动发布信息></p><p><img src=/Docsy/images/rqt-graph-manual-pub.png alt="rqt_graph 手动发布"></p><ol start=2><li><strong>发布空数据</strong>：</li></ol><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>ros2 topic pub /chatter std_msgs/msg/String
</span></span></code></pre></div><p>因为很少会使用到手动 pub 消息，其他两种自动构建数据结构并发布的方式暂时不考虑。</p><h4 id=消息的时间戳>消息的时间戳</h4><p>当发布带时间戳的消息时，<code>pub</code> 有两种方法可以自动填充当前时间。对于带有 <code>std_msgs/msg/Header</code> 的消息，可以将 header 字段设置为 <code>auto</code> 来填充 stamp 字段。</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>ros2 topic pub /chatter std_msgs/msg/String <span style=color:#4e9a06>&#34;{header: \&#34;auto\&#34;, data: &#39;Hello from manual pub.&#39;}&#34;</span>
</span></span></code></pre></div><p>此时会报错，因为 <code>std_msgs/msg/String</code> 类型没有 header 字段。</p><h3 id=27-查询-topic-发布频率>2.7 查询 topic 发布频率</h3><p>使用以下命令来得知对应 topic 的发布频率：</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>ros2 topic hz &lt;topic&gt;
</span></span></code></pre></div><p>例如：</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>ros2 topic hz /chatter
</span></span></code></pre></div><p>在检测后会返回：</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>average rate: 1.000 
</span></span><span style=display:flex><span>min: 1.000s max: 1.000s std dev: 0.00021s window: <span style=color:#0000cf;font-weight:700>3</span>
</span></span></code></pre></div><h3 id=28-查询-topic-带宽>2.8 查询 topic 带宽</h3><p>使用以下命令查询 topic 的带宽使用情况：</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>ros2 topic bw &lt;topic&gt;
</span></span></code></pre></div><p>例如：</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>ros2 topic bw /chatter
</span></span></code></pre></div><p>输出示例：</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>Subscribed to <span style=color:#ce5c00;font-weight:700>[</span>/chatter<span style=color:#ce5c00;font-weight:700>]</span>
</span></span><span style=display:flex><span><span style=color:#0000cf;font-weight:700>49</span> B/s from <span style=color:#0000cf;font-weight:700>2</span> messages
</span></span><span style=display:flex><span>Message size mean: <span style=color:#0000cf;font-weight:700>28</span> B min: <span style=color:#0000cf;font-weight:700>28</span> B max: <span style=color:#0000cf;font-weight:700>28</span> B
</span></span><span style=display:flex><span><span style=color:#0000cf;font-weight:700>39</span> B/s from <span style=color:#0000cf;font-weight:700>3</span> messages
</span></span><span style=display:flex><span>Message size mean: <span style=color:#0000cf;font-weight:700>28</span> B min: <span style=color:#0000cf;font-weight:700>28</span> B max: <span style=color:#0000cf;font-weight:700>28</span> B
</span></span></code></pre></div><p>返回带宽利用率和发布到 topic 的消息数量。</p><h3 id=29-查询指定类型的-topic>2.9 查询指定类型的 topic</h3><p>列出给定类型的可用 topic 列表：</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>ros2 topic find &lt;topic_type&gt;
</span></span></code></pre></div><p>根据前文可以得知，<code>topic_type</code> 为 <code>ros2 topic list -t</code> 返回的括号中的内容，例如 <code>std_msgs/msg/String</code>。</p><p>执行：</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>ros2 topic find std_msgs/msg/String
</span></span></code></pre></div><p>输出：</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>/chatter
</span></span></code></pre></div><h2 id=3-总结>3. 总结</h2><p>node 通过 topic 发布信息，允许任意数量的其他 node 订阅和访问该信息。笔记中使用 <code>rqt_graph</code> 和命令行工具检查了 topic 上多个 node 之间的连接。由此，可以初步理解数据如何在 ROS 2 系统中移动。</p><hr><h2 id=4-参考文档>4. 参考文档</h2><ul><li><a href=https://docs.ros.org/en/jazzy/Tutorials/Beginner-CLI-Tools/Understanding-ROS2-Nodes/Understanding-ROS2-Nodes.html>Understanding ROS 2 nodes</a></li><li><a href=https://docs.ros.org/en/jazzy/Tutorials/Beginner-CLI-Tools/Understanding-ROS2-Topics/Understanding-ROS2-Topics.html>Understanding ROS 2 topics</a></li></ul></div><div class=td-content style=page-break-before:always><h1 id=pg-6f2539b6d098ac8698b8c0db03e709c5>理解 ROS 2 的 Services, Params 和 Actions</h1><div class="td-byline mb-4"><time datetime=2026-02-25 class=text-body-secondary>2026年2月25日</time></div><h2 id=1-理解-services>1. 理解 services</h2><p>services 是 ROS 图中节点通信的另一种方法。services 基于调用和响应模型，而不是主题的pub-sub模型。虽然主题允许节点订阅数据流并获取持续更新，但 services 仅在 client 专门调用时才提供数据。</p><p>节点可以使用 ROS 2 中的 services 进行通信。与主题（一种单向通信模式，其中节点发布可供一个或多个订阅者使用的信息）不同，services 是一种请求/响应模式，其中 client 向提供 services node发出请求，services 处理该请求并生成响应。</p><p><img src=/Docsy/images/Service-SingleServiceClient.gif alt="单 services client"></p><p><img src=/Docsy/images/Service-MultipleServiceClient.gif alt="多 services clients"></p><h3 id=11-查看-ros-2-当前-services>1.1 查看 ROS 2 当前 services</h3><p>通过 <code>ros2 service list</code> 返回系统中当前活动的所有 services 的列表。</p><p>在两个终端内分别运行 subscriber 和 publisher node：</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>ros2 run demo_nodes_cpp talker
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>ros2 run demo_nodes_cpp listener
</span></span></code></pre></div><p>执行 <code>ros2 service list</code>，返回：</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ ros2 service list
</span></span><span style=display:flex><span>/listener/describe_parameters
</span></span><span style=display:flex><span>/listener/get_parameter_types
</span></span><span style=display:flex><span>/listener/get_parameters
</span></span><span style=display:flex><span>/listener/get_type_description
</span></span><span style=display:flex><span>/listener/list_parameters
</span></span><span style=display:flex><span>/listener/set_parameters
</span></span><span style=display:flex><span>/listener/set_parameters_atomically
</span></span><span style=display:flex><span>/rqt_gui_py_node_103317/describe_parameters
</span></span><span style=display:flex><span>/rqt_gui_py_node_103317/get_parameter_types
</span></span><span style=display:flex><span>/rqt_gui_py_node_103317/get_parameters
</span></span><span style=display:flex><span>/rqt_gui_py_node_103317/get_type_description
</span></span><span style=display:flex><span>/rqt_gui_py_node_103317/list_parameters
</span></span><span style=display:flex><span>/rqt_gui_py_node_103317/set_parameters
</span></span><span style=display:flex><span>/rqt_gui_py_node_103317/set_parameters_atomically
</span></span><span style=display:flex><span>/talker/describe_parameters
</span></span><span style=display:flex><span>/talker/get_parameter_types
</span></span><span style=display:flex><span>/talker/get_parameters
</span></span><span style=display:flex><span>/talker/get_type_description
</span></span><span style=display:flex><span>/talker/list_parameters
</span></span><span style=display:flex><span>/talker/set_parameters
</span></span><span style=display:flex><span>/talker/set_parameters_atomically
</span></span></code></pre></div><p>可以观察到节点中有相同名称的多个服务，ROS 2 的大部分节点都有这些基础设施服务。</p><h3 id=12-查看-ros-2-services-类型>1.2 查看 ROS 2 services 类型</h3><p>服务具有描述服务的请求和响应数据的结构的类型。服务类型的定义与主题类型类似，不同之处在于服务类型有两部分：一个用于请求的消息，另一个用于响应。</p><p>查看 talker 的 services 类型：</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>ros2 service <span style=color:#204a87>type</span> /talker/set_parameters
</span></span></code></pre></div><p>返回：</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>rcl_interfaces/srv/SetParameters
</span></span></code></pre></div><p>也可以通过在 services 列表中增加 <code>-t</code> 参数来直接显示所有当前 services 对应的类型：</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>ros2 service list -t
</span></span></code></pre></div><p>返回：</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>/listener/describe_parameters [rcl_interfaces/srv/DescribeParameters]
</span></span><span style=display:flex><span>/listener/get_parameter_types [rcl_interfaces/srv/GetParameterTypes]
</span></span><span style=display:flex><span>/listener/get_parameters [rcl_interfaces/srv/GetParameters]
</span></span><span style=display:flex><span>/listener/get_type_description [type_description_interfaces/srv/GetTypeDescription]
</span></span><span style=display:flex><span>/listener/list_parameters [rcl_interfaces/srv/ListParameters]
</span></span><span style=display:flex><span>/listener/set_parameters [rcl_interfaces/srv/SetParameters]
</span></span><span style=display:flex><span>/listener/set_parameters_atomically [rcl_interfaces/srv/SetParametersAtomically]
</span></span><span style=display:flex><span>/rqt_gui_py_node_103317/describe_parameters [rcl_interfaces/srv/DescribeParameters]
</span></span><span style=display:flex><span>/rqt_gui_py_node_103317/get_parameter_types [rcl_interfaces/srv/GetParameterTypes]
</span></span><span style=display:flex><span>/rqt_gui_py_node_103317/get_parameters [rcl_interfaces/srv/GetParameters]
</span></span><span style=display:flex><span>/rqt_gui_py_node_103317/get_type_description [type_description_interfaces/srv/GetTypeDescription]
</span></span><span style=display:flex><span>/rqt_gui_py_node_103317/list_parameters [rcl_interfaces/srv/ListParameters]
</span></span><span style=display:flex><span>/rqt_gui_py_node_103317/set_parameters [rcl_interfaces/srv/SetParameters]
</span></span><span style=display:flex><span>/rqt_gui_py_node_103317/set_parameters_atomically [rcl_interfaces/srv/SetParametersAtomically]
</span></span><span style=display:flex><span>/talker/describe_parameters [rcl_interfaces/srv/DescribeParameters]
</span></span><span style=display:flex><span>/talker/get_parameter_types [rcl_interfaces/srv/GetParameterTypes]
</span></span><span style=display:flex><span>/talker/get_parameters [rcl_interfaces/srv/GetParameters]
</span></span><span style=display:flex><span>/talker/get_type_description [type_description_interfaces/srv/GetTypeDescription]
</span></span><span style=display:flex><span>/talker/list_parameters [rcl_interfaces/srv/ListParameters]
</span></span><span style=display:flex><span>/talker/set_parameters [rcl_interfaces/srv/SetParameters]
</span></span><span style=display:flex><span>/talker/set_parameters_atomically [rcl_interfaces/srv/SetParametersAtomically]
</span></span></code></pre></div><h3 id=13-查看-ros-2-services-信息>1.3 查看 ROS 2 services 信息</h3><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>ros2 service info &lt;service_name&gt;
</span></span></code></pre></div><p>返回 services 类型以及 services clients 和服务器的计数。</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>ros2 service info /talker/set_parameters
</span></span></code></pre></div><p>返回：</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>Type: rcl_interfaces/srv/SetParameters
</span></span><span style=display:flex><span>Clients count: 0
</span></span><span style=display:flex><span>Services count: 1
</span></span></code></pre></div><h3 id=14-查询指定类型的-services>1.4 查询指定类型的 services</h3><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>ros2 service find &lt;type_name&gt;
</span></span></code></pre></div><p>例如：</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>ros2 service find rcl_interfaces/srv/DescribeParameters
</span></span></code></pre></div><p>返回：</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>/listener/describe_parameters
</span></span><span style=display:flex><span>/rqt_gui_py_node_103317/describe_parameters
</span></span><span style=display:flex><span>/talker/describe_parameters
</span></span></code></pre></div><h3 id=15-查看-services-的接口协议>1.5 查看 services 的接口/协议</h3><p>与 topic 的接口查询一样，只是查询主体换成了<strong>services 类型</strong>。例如：</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>ros2 interface show rcl_interfaces/srv/DescribeParameters
</span></span></code></pre></div><p>返回：</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span># A list of parameters of which to get the descriptor.
</span></span><span style=display:flex><span>string[] names
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>---
</span></span><span style=display:flex><span># A list of the descriptors of all parameters requested in the same order
</span></span><span style=display:flex><span># as they were requested. This list has the same length as the list of
</span></span><span style=display:flex><span># parameters requested.
</span></span><span style=display:flex><span>ParameterDescriptor[] descriptors
</span></span><span style=display:flex><span>    string name
</span></span><span style=display:flex><span>    uint8 type
</span></span><span style=display:flex><span>    string description
</span></span><span style=display:flex><span>    #
</span></span><span style=display:flex><span>    string additional_constraints
</span></span><span style=display:flex><span>    bool read_only false
</span></span><span style=display:flex><span>    bool dynamic_typing false
</span></span><span style=display:flex><span>    #
</span></span><span style=display:flex><span>    FloatingPointRange[&lt;=1] floating_point_range
</span></span><span style=display:flex><span>        float64 from_value
</span></span><span style=display:flex><span>        float64 to_value
</span></span><span style=display:flex><span>        #
</span></span><span style=display:flex><span>        #
</span></span><span style=display:flex><span>        #
</span></span><span style=display:flex><span>        #
</span></span><span style=display:flex><span>        float64 step
</span></span><span style=display:flex><span>    IntegerRange[&lt;=1] integer_range
</span></span><span style=display:flex><span>        int64 from_value
</span></span><span style=display:flex><span>        int64 to_value
</span></span><span style=display:flex><span>        #
</span></span><span style=display:flex><span>        #
</span></span><span style=display:flex><span>        #
</span></span><span style=display:flex><span>        uint64 step
</span></span></code></pre></div><p><code>---</code> 分隔符上面是请求结构，即调用 services 需要输入的参数，下面是响应结构，即 services 返回的数据结构。注意：同一个 services 类型使用相同的数据结构/协议。</p><h3 id=16-ros-2-services-调用>1.6 ROS 2 services 调用</h3><p>从上文已经得知了调用 services 所需的数据结构，现在可以通过以下命令来调用 services：</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>ros2 service call &lt;service_name&gt; &lt;service_type&gt; &lt;arguments&gt;
</span></span></code></pre></div><p>这里尝试调用没有参数的 services：</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>ros2 service call /talker/list_parameters rcl_interfaces/srv/ListParameters
</span></span></code></pre></div><p>返回：</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>waiting for service to become available...
</span></span><span style=display:flex><span>requester: making request: rcl_interfaces.srv.ListParameters_Request(prefixes=[], depth=0)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>response:
</span></span><span style=display:flex><span>rcl_interfaces.srv.ListParameters_Response(result=rcl_interfaces.msg.ListParametersResult(names=[&#39;qos_overrides./parameter_events.publisher.depth&#39;, &#39;qos_overrides./parameter_events.publisher.durability&#39;, &#39;qos_overrides./parameter_events.publisher.history&#39;, &#39;qos_overrides./parameter_events.publisher.reliability&#39;, &#39;start_type_description_service&#39;, &#39;use_sim_time&#39;], prefixes=[&#39;qos_overrides./parameter_events.publisher&#39;]))
</span></span></code></pre></div><p>列出了当前节点拥有的参数。</p><h3 id=17-ros-2-services-echo>1.7 ROS 2 services echo</h3><p>查看 services clients 和 services 服务器之间的数据通信，使用命令 echo 对应的 services：</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>ros2 service <span style=color:#204a87>echo</span> &lt;service_name <span style=color:#000;font-weight:700>|</span> service_type&gt; &lt;arguments&gt;
</span></span></code></pre></div><p><code>echo service_name</code> 或者 <code>service_type</code> 都可以。</p><p><code>ros2 service echo</code> 依赖于 services clients 和 services 服务器的 services 自省功能，该功能默认是禁用的。要启用它，用户必须在创建 services clients 或服务器后调用 <code>configure_introspection</code>。</p><p>启动 services 自省演示：</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>ros2 launch demo_nodes_cpp introspect_services_launch.py
</span></span></code></pre></div><p>然后打开一个新的终端，启用 services 自省：</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>ros2 param <span style=color:#204a87>set</span> /introspection_service service_configure_introspection contents
</span></span><span style=display:flex><span>ros2 param <span style=color:#204a87>set</span> /introspection_client client_configure_introspection contents
</span></span></code></pre></div><p>在新终端内，继续执行：</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>ros2 service <span style=color:#204a87>echo</span> --flow-style /add_two_ints
</span></span></code></pre></div><p>可以看到 <code>introspection_client</code> 和 <code>introspection_service</code> 的通信情况，<code>REQUEST_SENT</code>，<code>REQUEST_RECEIVED</code>，<code>RESPONSE_SENT</code>，<code>RESPONSE_RECEIVED</code> 都被展示出来了：</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>---
</span></span><span style=display:flex><span>info:
</span></span><span style=display:flex><span>  event_type: REQUEST_SENT
</span></span><span style=display:flex><span>  stamp:
</span></span><span style=display:flex><span>    sec: 1762498810
</span></span><span style=display:flex><span>    nanosec: 268090535
</span></span><span style=display:flex><span>  client_gid: [1, 15, 178, 36, 79, 84, 235, 99, 0, 0, 0, 0, 0, 0, 21, 3]
</span></span><span style=display:flex><span>  sequence_number: 387
</span></span><span style=display:flex><span>  request: [{a: 2, b: 3}]
</span></span><span style=display:flex><span>  response: []
</span></span><span style=display:flex><span>---
</span></span><span style=display:flex><span>info:
</span></span><span style=display:flex><span>  event_type: REQUEST_RECEIVED
</span></span><span style=display:flex><span>  stamp:
</span></span><span style=display:flex><span>    sec: 1762498810
</span></span><span style=display:flex><span>    nanosec: 268466526
</span></span><span style=display:flex><span>  client_gid: [1, 15, 178, 36, 79, 84, 235, 99, 0, 0, 0, 0, 0, 0, 20, 4]
</span></span><span style=display:flex><span>  sequence_number: 387
</span></span><span style=display:flex><span>  request: [{a: 2, b: 3}]
</span></span><span style=display:flex><span>  response: []
</span></span><span style=display:flex><span>---
</span></span><span style=display:flex><span>info:
</span></span><span style=display:flex><span>  event_type: RESPONSE_SENT
</span></span><span style=display:flex><span>  stamp:
</span></span><span style=display:flex><span>    sec: 1762498810
</span></span><span style=display:flex><span>    nanosec: 268538042
</span></span><span style=display:flex><span>  client_gid: [1, 15, 178, 36, 79, 84, 235, 99, 0, 0, 0, 0, 0, 0, 20, 4]
</span></span><span style=display:flex><span>  sequence_number: 387
</span></span><span style=display:flex><span>  request: []
</span></span><span style=display:flex><span>  response: [{sum: 5}]
</span></span><span style=display:flex><span>---
</span></span><span style=display:flex><span>info:
</span></span><span style=display:flex><span>  event_type: RESPONSE_RECEIVED
</span></span><span style=display:flex><span>  stamp:
</span></span><span style=display:flex><span>    sec: 1762498810
</span></span><span style=display:flex><span>    nanosec: 268637789
</span></span><span style=display:flex><span>  client_gid: [1, 15, 178, 36, 79, 84, 235, 99, 0, 0, 0, 0, 0, 0, 21, 3]
</span></span><span style=display:flex><span>  sequence_number: 387
</span></span><span style=display:flex><span>  request: []
</span></span><span style=display:flex><span>  response: [{sum: 5}]
</span></span><span style=display:flex><span>---
</span></span></code></pre></div><h2 id=2-理解参数>2. 理解参数</h2><p>参数就是 node 的配置，node 将参数存储为不同的数据类型，ROS 2 每个 node 都维护自己的参数。</p><p>节点使用参数来定义其默认配置值。您可以从命令行获取和设置参数值。您还可以将参数设置保存到文件中，以便在将来的会话中重新加载它们。</p><h3 id=21-查看-ros-2-的参数列表>2.1 查看 ROS 2 的参数列表</h3><p>启动 subscriber 和 publisher node：</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>ros2 run demo_nodes_cpp talker
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>ros2 run demo_nodes_cpp listener
</span></span></code></pre></div><p>查看参数列表：</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>ros2 param list
</span></span></code></pre></div><p>返回示例：</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>/introspection_client:
</span></span><span style=display:flex><span>  client_configure_introspection
</span></span><span style=display:flex><span>  qos_overrides./parameter_events.publisher.depth
</span></span><span style=display:flex><span>  qos_overrides./parameter_events.publisher.durability
</span></span><span style=display:flex><span>  qos_overrides./parameter_events.publisher.history
</span></span><span style=display:flex><span>  qos_overrides./parameter_events.publisher.reliability
</span></span><span style=display:flex><span>  start_type_description_service
</span></span><span style=display:flex><span>  use_sim_time
</span></span><span style=display:flex><span>/introspection_service:
</span></span><span style=display:flex><span>  qos_overrides./parameter_events.publisher.depth
</span></span><span style=display:flex><span>  qos_overrides./parameter_events.publisher.durability
</span></span><span style=display:flex><span>  qos_overrides./parameter_events.publisher.history
</span></span><span style=display:flex><span>  qos_overrides./parameter_events.publisher.reliability
</span></span><span style=display:flex><span>  service_configure_introspection
</span></span><span style=display:flex><span>  start_type_description_service
</span></span><span style=display:flex><span>  use_sim_time
</span></span><span style=display:flex><span>/listener:
</span></span><span style=display:flex><span>  start_type_description_service
</span></span><span style=display:flex><span>  use_sim_time
</span></span><span style=display:flex><span>/talker:
</span></span><span style=display:flex><span>  qos_overrides./parameter_events.publisher.depth
</span></span><span style=display:flex><span>  qos_overrides./parameter_events.publisher.durability
</span></span><span style=display:flex><span>  qos_overrides./parameter_events.publisher.history
</span></span><span style=display:flex><span>  qos_overrides./parameter_events.publisher.reliability
</span></span><span style=display:flex><span>  start_type_description_service
</span></span><span style=display:flex><span>  use_sim_time
</span></span></code></pre></div><p>可以看到节点的 namespace 和其参数，注意：每个 node 都有 <code>use_sim_time</code>。</p><h3 id=22-查看参数类型>2.2 查看参数类型</h3><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>ros2 param get &lt;node_name&gt; &lt;parameter_name&gt;
</span></span></code></pre></div><p>返回类型和当前值。查看 <code>start_type_description_service</code> 的当前值和类型：</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>ros2 param get /listener start_type_description_service
</span></span></code></pre></div><p>返回：</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>Boolean value is: True
</span></span></code></pre></div><h3 id=23-修改参数>2.3 修改参数</h3><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>ros2 param <span style=color:#204a87>set</span> &lt;node_name&gt; &lt;parameter_name&gt; &lt;value&gt;
</span></span></code></pre></div><p>尝试修改 listener 为 false：</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>ros2 param <span style=color:#204a87>set</span> /listener start_type_description_service False
</span></span></code></pre></div><p>返回：</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>Setting parameter failed: Trying to set a read-only parameter: start_type_description_service.
</span></span></code></pre></div><p>传参成功了，但是因为这个参数是只读的，所以无法修改。</p><h3 id=24-导出-ros-2-参数>2.4 导出 ROS 2 参数</h3><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>ros2 param dump &lt;node_name&gt;
</span></span></code></pre></div><p>运行：</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>ros2 param dump /talker
</span></span></code></pre></div><p>返回：</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>/talker</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>ros__parameters</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>qos_overrides</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>/parameter_events</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>publisher</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>depth</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>1000</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>durability</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>volatile</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>history</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>keep_last</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>reliability</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>reliable</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>start_type_description_service</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>true</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>use_sim_time</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>false</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><p>默认将在命令行打印，也可以通过以下命令指定输出文件到当前终端的工作目录：</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>ros2 param dump /talker &gt; talker.yaml
</span></span></code></pre></div><h3 id=25-加载-ros-2-参数>2.5 加载 ROS 2 参数</h3><p>使用命令加载参数文件到运行中的 node：</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>ros2 param load &lt;node_name&gt; &lt;parameter_file&gt;
</span></span></code></pre></div><p>例如：</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>ros2 param load /talker talker.yaml
</span></span></code></pre></div><p>返回：</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>Set parameter qos_overrides./parameter_events.publisher.depth failed: parameter &#39;qos_overrides./parameter_events.publisher.depth&#39; cannot be set because it is read-only
</span></span><span style=display:flex><span>Set parameter qos_overrides./parameter_events.publisher.durability failed: parameter &#39;qos_overrides./parameter_events.publisher.durability&#39; cannot be set because it is read-only
</span></span><span style=display:flex><span>Set parameter qos_overrides./parameter_events.publisher.history failed: parameter &#39;qos_overrides./parameter_events.publisher.history&#39; cannot be set because it is read-only
</span></span><span style=display:flex><span>Set parameter qos_overrides./parameter_events.publisher.reliability failed: parameter &#39;qos_overrides./parameter_events.publisher.reliability&#39; cannot be set because it is read-only
</span></span><span style=display:flex><span>Set parameter start_type_description_service failed: parameter &#39;start_type_description_service&#39; cannot be set because it is read-only
</span></span><span style=display:flex><span>Set parameter use_sim_time successful
</span></span></code></pre></div><p>可以看到，所有的参数都被尝试设置了，仅 <code>use_sim_time</code> 这个非 read-only 的参数覆写成功了。只读参数只能在启动时修改，而不能在启动后修改，这就是为什么 &ldquo;qos_overrides&rdquo; 参数会出现一些警告。</p><h3 id=26-node-启动时加载参数>2.6 node 启动时加载参数</h3><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>ros2 run demo_nodes_cpp talker --ros-args --params-file talker.yaml
</span></span></code></pre></div><p>命令行不会有额外打印信息，但是 read-only 的参数此时会生效。</p><h2 id=3-理解-action>3. 理解 action</h2><p>动作（Actions）是 ROS 2 中的通信类型之一，用于长时间运行的任务。它们由三个部分组成：目标（goal）、反馈（feedback）和结果（result）。</p><p>action 基于主题和 services 构建。它们的功能类似于 services，但 action 可以被取消。它们还提供稳定的反馈，这与返回单个响应的 services 不同。</p><p><img src=/Docsy/images/Action-SingleActionClient.gif alt="单 action client"></p><p>如图所示，action 使用 client-server 模型，与 pub sub 模型类似。action client node 将信息发送到 action server node，然后 server node 处理并返回结果。</p><p>仔细看图，client 先发一个 goal request 到 server，得到 server 的 response 后，client 发送 result request 到 server，此时 server 通过 feedback topic 与 client 保持连接，同步状态等，直到处理完成后，通过 result response 返回处理后的信息给 client。这个架构比仅用 topic 或者 services 都要复杂，但是强大、更加现代化，对复杂系统兼容性强，易于管理。</p><h3 id=31-使用-action>3.1 使用 action</h3><p>打开两个终端，分别运行：</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>ros2 run turtlesim turtlesim_node
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>ros2 run turtlesim turtle_teleop_key
</span></span></code></pre></div><p>启动控制 node 后，看到提示信息：<code>Use g|b|v|c|d|e|r|t keys to rotate to absolute orientations. 'f' to cancel a rotation.</code></p><p>其中 <code>g|b|v|c|d|e|r|t</code> 围绕键盘的 <code>f</code> 按键形成一个圆圈，按下对应方向的按键即命令乌龟转向对应的方向，比如按 <code>t</code>，是让乌龟朝向右上方。</p><p>按下 <code>t</code> 后，node 窗口会打印：</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>[INFO] [1762503823.706663289] [turtlesim]: Rotation goal completed successfully
</span></span></code></pre></div><p>如果在转向的过程中按下另一个方向，会打印：</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>[WARN] [1762503902.170788364] [turtlesim]: Rotation goal received before a previous goal finished. Aborting previous goal.
</span></span></code></pre></div><p>该 action 服务器选择中止第一个目标，因为它有了一个新目标。它可以选择其他目标，例如拒绝新目标或在第一个目标完成后执行第二个目标。</p><p>通过 <code>ros2 node info /turtlesim</code> 可以发现返回值中存在：</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>Service Clients:
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Action Servers:
</span></span><span style=display:flex><span>    /turtle1/rotate_absolute: turtlesim/action/RotateAbsolute
</span></span><span style=display:flex><span>Action Clients:
</span></span></code></pre></div><p>可以得知这是基于 action 实现的复杂功能，而不是每个使用了 action 的 node 就天然具备的功能。</p><h3 id=32-查看-ros-2-action-列表>3.2 查看 ROS 2 action 列表</h3><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>ros2 action list
</span></span></code></pre></div><p>返回：</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>/turtle1/rotate_absolute
</span></span></code></pre></div><p>和其他的 list 命令一样，可以通过 <code>-t</code> 来查看 action 的类型：</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>ros2 action list -t
</span></span></code></pre></div><p>返回：</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>/turtle1/rotate_absolute [turtlesim/action/RotateAbsolute]
</span></span></code></pre></div><h3 id=33-查看-ros-2-action-类型>3.3 查看 ROS 2 action 类型</h3><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>ros2 action <span style=color:#204a87>type</span> &lt;action&gt;
</span></span></code></pre></div><p>例如：</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>ros2 action <span style=color:#204a87>type</span> /turtle1/rotate_absolute
</span></span></code></pre></div><p>返回：</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>turtlesim/action/RotateAbsolute
</span></span></code></pre></div><h3 id=34-查看-ros-2-action-信息>3.4 查看 ROS 2 action 信息</h3><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>ros2 action info &lt;action&gt;
</span></span></code></pre></div><p>例如：</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>ros2 action info /turtle1/rotate_absolute
</span></span></code></pre></div><p>返回：</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>Action: /turtle1/rotate_absolute
</span></span><span style=display:flex><span>Action clients: 1
</span></span><span style=display:flex><span>    /teleop_turtle
</span></span><span style=display:flex><span>Action servers: 1
</span></span><span style=display:flex><span>    /turtlesim
</span></span></code></pre></div><p>可以看到 action clients 和 servers 都直接打印出来了。</p><h3 id=35-查看-ros-2-action-的接口>3.5 查看 ROS 2 action 的接口</h3><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>ros2 interface show &lt;action_type&gt;
</span></span></code></pre></div><p>例如：</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>ros2 interface show turtlesim/action/RotateAbsolute
</span></span></code></pre></div><p>返回：</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span># The desired heading in radians
</span></span><span style=display:flex><span>float32 theta
</span></span><span style=display:flex><span>---
</span></span><span style=display:flex><span># The angular displacement in radians to the starting position
</span></span><span style=display:flex><span>float32 delta
</span></span><span style=display:flex><span>---
</span></span><span style=display:flex><span># The remaining rotation in radians
</span></span><span style=display:flex><span>float32 remaining
</span></span></code></pre></div><p>第一部分（第一个 <code>---</code> 上方）是 goal 的结构，第二部分（第一个 <code>---</code> 和第二个 <code>---</code> 之间）是 result 的结构，最后一部分（第二个 <code>---</code> 下方）是 feedback 的结构，如<a href=/docsy/blog/02/25/2026/%E7%90%86%E8%A7%A3-ros-2-%E7%9A%84-services-params-%E5%92%8C-actions/#31-%e4%bd%bf%e7%94%a8-action>上图</a>所示。</p><h3 id=36-ros-2-action-发送-goal>3.6 ROS 2 action 发送 goal</h3><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>ros2 action send_goal &lt;action_name&gt; &lt;action_type&gt; &lt;values&gt;
</span></span></code></pre></div><p><code>&lt;values></code> 需要是 YAML 格式。在终端输入：</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>ros2 action send_goal /turtle1/rotate_absolute turtlesim/action/RotateAbsolute <span style=color:#4e9a06>&#34;{theta: -1.57}&#34;</span> --feedback
</span></span></code></pre></div><p>可以看到海龟开始旋转。返回：</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>Waiting for an action server to become available...
</span></span><span style=display:flex><span>Sending goal:
</span></span><span style=display:flex><span>   theta: -1.57
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Goal accepted with ID: e6092c831f994afda92f0086f220da27
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Feedback:
</span></span><span style=display:flex><span>  remaining: -3.1268222332000732
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Feedback:
</span></span><span style=display:flex><span>  remaining: -3.1108222007751465
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>...
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Result:
</span></span><span style=display:flex><span>  delta: 3.1200008392333984
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Goal finished with status: SUCCEEDED
</span></span></code></pre></div><p>Feedback 展示的是剩余的弧度，直到完成。action client 通过 send goal 到 action server 来实现对海龟的旋转。</p><h2 id=4-总结>4. 总结</h2><p>本文介绍了 ROS 2 中三种重要的通信和配置机制：</p><ol><li><p><strong>服务（Services）</strong>：基于请求/响应模型的通信方式，适用于需要即时响应的操作。服务允许客户端向服务器发送请求并接收响应，与主题的单向通信不同，服务提供了双向通信能力。</p></li><li><p><strong>参数（Parameters）</strong>：节点的配置值，用于定义节点的默认行为。参数可以在运行时查询和修改（非只读参数），也可以保存到文件中以便在将来的会话中重新加载。只读参数只能在节点启动时设置。</p></li><li><p><strong>动作（Actions）</strong>：用于长时间运行任务的通信机制，由目标、反馈和结果三部分组成。动作基于主题和服务构建，提供了可取消的任务执行和定期反馈功能，非常适合需要长时间运行且需要进度更新的任务，如机器人导航。</p></li></ol><p>机器人系统可能会使用 action 进行导航。action 目标可以告诉机器人前往某个位置。当机器人导航到该位置时，它可以沿途发送更新（即反馈），然后在到达目的地后发送最终结果消息。</p><p>通过理解这三种机制，可以更好地设计和实现 ROS 2 机器人系统，选择合适的通信方式来处理不同的任务需求。</p><hr><h2 id=参考文档>参考文档</h2><ul><li><a href=https://docs.ros.org/en/jazzy/Tutorials/Beginner-CLI-Tools/Understanding-ROS2-Services/Understanding-ROS2-Services.html>Understanding ROS 2 services</a></li><li><a href=https://docs.ros.org/en/jazzy/Tutorials/Beginner-CLI-Tools/Understanding-ROS2-Parameters/Understanding-ROS2-Parameters.html>Understanding ROS 2 parameters</a></li><li><a href=https://docs.ros.org/en/jazzy/Tutorials/Beginner-CLI-Tools/Understanding-ROS2-Actions/Understanding-ROS2-Actions.html>Understanding ROS 2 action</a></li></ul></div></main></div></div><footer class="td-footer row d-print-none"><div class=container-fluid><div class="row mx-md-2"><div class="td-footer__left col-6 col-sm-4 order-sm-1"><ul class=td-footer__links-list><li class=td-footer__links-item data-bs-toggle=tooltip title=Mail aria-label=Mail><a target=_blank rel=noopener href=/about/ aria-label=Mail><i class="fa fa-envelope"></i></a></li><li class=td-footer__links-item data-bs-toggle=tooltip title=Wechat aria-label=Wechat><a target=_blank rel=noopener href=/about/ aria-label=Wechat><i class="fab fa-weixin"></i></a></li><li class=td-footer__links-item data-bs-toggle=tooltip title=QQ aria-label=QQ><a target=_blank rel=noopener href=/about/ aria-label=QQ><i class="fab fa-qq"></i></a></li><li class=td-footer__links-item data-bs-toggle=tooltip title=Wallhaven aria-label=Wallhaven><a target=_blank rel=noopener href=https://wallhaven.cc/user/Zero-kq/favorites/1954116 aria-label=Wallhaven><i class="fa fa-image"></i></a></li></ul></div><div class="td-footer__right col-6 col-sm-4 order-sm-3"><ul class=td-footer__links-list><li class=td-footer__links-item data-bs-toggle=tooltip title="Docsy & Template" aria-label="Docsy & Template"><a target=_blank rel=noopener href=https://github.com/google/docsy aria-label="Docsy & Template"><i class="fab fa-github"></i></a></li></ul></div><div class="td-footer__center col-12 col-sm-4 py-2 order-sm-2"><span class=td-footer__copyright>&copy;
2018&ndash;2026
<span class=td-footer__authors>Docsy Authors | <a href=https://creativecommons.org/licenses/by/4.0>CC BY 4.0</a> |</span></span><span class=td-footer__all_rights_reserved>保留所有权利</span><span class=ms-2><a href=https://policies.google.com/privacy target=_blank rel=noopener>隐私政策</a></span></div></div></div></footer></div><script src=/docsy/js/main.min.b540f305b126afbbf8653419bb091d1c388e5adc77b849e8a878766c4de19b67.js integrity="sha256-tUDzBbEmr7v4ZTQZuwkdHDiOWtx3uEnoqHh2bE3hm2c=" crossorigin=anonymous></script><script defer src=/docsy/js/click-to-copy.min.73478a7d4807698aed7e355eb23f9890ca18fea3158604c8471746d046702bad.js integrity="sha256-c0eKfUgHaYrtfjVesj+YkMoY/qMVhgTIRxdG0EZwK60=" crossorigin=anonymous></script><script src=/docsy/js/tabpane-persist.js></script></body></html>