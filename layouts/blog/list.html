{{ define "main" }}
{{ if and (eq .Section "blog") (ne .IsHome true) }}
<style>
/* 为博客分类页面设置背景 */
body {
    background-image: url('{{ .Site.Params.blogBackground }}');
    background-size: cover;
    background-position: center;
    background-attachment: fixed;
    background-repeat: no-repeat;
}
</style>
{{ end }}
<div class="td-content blog-page">
  <h1>{{ .Title }}</h1>
  
  {{ if .Content }}
  <div class="blog-intro">
    {{ .Content }}
  </div>
  {{ end }}

  {{ if eq .Section "blog" }}
    {{ $subsections := where .Site.Sections "Parent" . }}
    {{ if $subsections }}
      <div class="blog-collections mt-4">
        <div class="row">
          {{ range $subsections.ByWeight }}
            <div class="col-md-6 col-lg-4 mb-4">
              <div class="blog-collection-card">
                <div class="blog-collection-content">
                  <h5 class="blog-collection-title">
                    <a href="{{ .RelPermalink }}">{{ .Title }}</a>
                  </h5>
                  <p class="blog-collection-description">
                    {{ if .Params.description }}
                      {{ .Params.description }}
                    {{ else if .Summary }}
                      {{ .Summary }}
                    {{ else }}
                      {{ .Content | truncate 100 }}
                    {{ end }}
                  </p>
                  <div class="blog-collection-meta">
                    <span class="blog-collection-count">
                      {{ len .Pages }} {{ i18n "articles" | default "articles" }}
                    </span>
                  </div>
                </div>
              </div>
            </div>
          {{ end }}
        </div>
      </div>
    {{ end }}
  {{ end }}

  <div class="blog-posts mt-4">
    {{ $paginator := .Paginate .Pages }}
    {{ if gt (len $paginator.Pages) 0 }}
      {{ range $paginator.Pages }}
        <a href="{{ .RelPermalink }}" class="blog-post-container mb-4 noselect">
          <div class="blog-post-canvas">
            <div class="blog-post-tracker tr-1"></div>
            <div class="blog-post-tracker tr-2"></div>
            <div class="blog-post-tracker tr-3"></div>
            <div class="blog-post-tracker tr-4"></div>
            <div class="blog-post-tracker tr-5"></div>
            <div class="blog-post-tracker tr-6"></div>
            <div class="blog-post-tracker tr-7"></div>
            <div class="blog-post-tracker tr-8"></div>
            <div class="blog-post-tracker tr-9"></div>
            <div class="blog-post-tracker tr-10"></div>
            <div class="blog-post-tracker tr-11"></div>
            <div class="blog-post-tracker tr-12"></div>
            <div class="blog-post-tracker tr-13"></div>
            <div class="blog-post-tracker tr-14"></div>
            <div class="blog-post-tracker tr-15"></div>
            <div class="blog-post-tracker tr-16"></div>
            <div class="blog-post-tracker tr-17"></div>
            <div class="blog-post-tracker tr-18"></div>
            <div class="blog-post-tracker tr-19"></div>
            <div class="blog-post-tracker tr-20"></div>
            <div class="blog-post-tracker tr-21"></div>
            <div class="blog-post-tracker tr-22"></div>
            <div class="blog-post-tracker tr-23"></div>
            <div class="blog-post-tracker tr-24"></div>
            <div class="blog-post-tracker tr-25"></div>
            <div class="blog-post-item" id="blog-card">
              <h3>{{ .Title }}</h3>
              <div class="blog-post-meta text-muted mb-2">
                <time datetime="{{ .Lastmod.Format "2006-01-02" }}">{{ i18n "last_updated" | default "Updated" }} {{ .Lastmod.Format "2006-01-02" }}</time>
                {{ if .Params.tags }}
                  {{ range first 8 .Params.tags }}
                    <span class="badge bg-secondary ms-1">{{ . }}</span>
                  {{ end }}
                {{ end }}
              </div>
              {{ if eq .Kind "section" }}
              <p>
                {{ if .Params.summary }}
                  {{ .Params.summary }}
                {{ else if .Params.description }}
                  {{ .Params.description }}
                {{ else }}
                  {{ .Summary }}
                {{ end }}
              </p>
              {{ end }}
            </div>
          </div>
        </a>
      {{ end }}

      {{ template "_internal/pagination.html" . }}
    {{ end }}
  </div>
</div>
<script defer src="{{ .Site.BaseURL }}js/custom-scrollbar.js"></script>
<script defer src="{{ .Site.BaseURL }}js/taxonomy-collapse.js"></script>
{{ end }}
